I"å<h3 id="introduction">Introduction</h3>

<p>Modern websites have a search bar, searching within the site for specific content. These search boxes often search the database in real-time. That is not possible within a static website. Therefore another solution must be found. An <a href="/search">demo</a> can be found on the search page.</p>

<h3 id="how-it-works">How it works</h3>

<p>This search relies on a local index. It uses the Lunr.js script to search. This script does not require jQuery. First a local index is build, using the documents variable. Then the Lunr.js code is called. Finally a custom-made function (called â€˜lunr_searchâ€™) puts the results in a Google-like style on the screen. Below you will find the code.</p>

<p>[expand]</p>

<pre><code>&lt;script src="/js/lunr.js"&gt;&lt;/script&gt;

&lt;script&gt;
{% assign counter = 0 %}
var documents = [{% for page in site.pages %}{% if page.url contains '.xml' or page.url contains 'assets' %}{% else %}{
    "id": {{ counter }},
    "url": "{{ site.url }}{{ page.url }}",
    "title": "{{ page.title }}",
    "body": "{{ page.content | markdownify | replace: '.', '. ' | replace: '&lt;/h2&gt;', ': ' | replace: '&lt;/h3&gt;', ': ' | replace: '&lt;/h4&gt;', ': ' | replace: '&lt;/p&gt;', ' ' | strip_html | strip_newlines | replace: '  ', ' ' | replace: '"', ' ' }}"{% assign counter = counter | plus: 1 %}
    }, {% endif %}{% endfor %}{% for page in site.without-plugin %}{
    "id": {{ counter }},
    "url": "{{ site.url }}{{ page.url }}",
    "title": "{{ page.title }}",
    "body": "{{ page.content | markdownify | replace: '.', '. ' | replace: '&lt;/h2&gt;', ': ' | replace: '&lt;/h3&gt;', ': ' | replace: '&lt;/h4&gt;', ': ' | replace: '&lt;/p&gt;', ' ' | strip_html | strip_newlines | replace: '  ', ' ' | replace: '"', ' ' }}"{% assign counter = counter | plus: 1 %}
    }, {% endfor %}{% for page in site.posts %}{
    "id": {{ counter }},
    "url": "{{ site.url }}{{ page.url }}",
    "title": "{{ page.title }}",
    "body": "{{ page.date | date: "%Y/%m/%d" }} - {{ page.content | markdownify | replace: '.', '. ' | replace: '&lt;/h2&gt;', ': ' | replace: '&lt;/h3&gt;', ': ' | replace: '&lt;/h4&gt;', ': ' | replace: '&lt;/p&gt;', ' ' | strip_html | strip_newlines | replace: '  ', ' ' | replace: '"', ' ' }}"{% assign counter = counter | plus: 1 %}
    }{% if forloop.last %}{% else %}, {% endif %}{% endfor %}];

var idx = lunr(function () {
    this.ref('id')
    this.field('title')
    this.field('body')

    documents.forEach(function (doc) {
        this.add(doc)
    }, this)
});
function lunr_search(term) {
    document.getElementById('lunrsearchresults').innerHTML = '&lt;ul&gt;&lt;/ul&gt;';
    if(term) {
        document.getElementById('lunrsearchresults').innerHTML = "&lt;p&gt;Search results for '" + term + "'&lt;/p&gt;" + document.getElementById('lunrsearchresults').innerHTML;
        //put results on the screen.
        var results = idx.search(term);
        if(results.length&gt;0){
            //console.log(idx.search(term));
            //if results
            for (var i = 0; i &lt; results.length; i++) {
                // more statements
                var ref = results[i]['ref'];
                var url = documents[ref]['url'];
                var title = documents[ref]['title'];
                var body = documents[ref]['body'].substring(0,160)+'...';
                document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML + "&lt;li class='lunrsearchresult'&gt;&lt;a href='" + url + "'&gt;&lt;span class='title'&gt;" + title + "&lt;/span&gt;&lt;br /&gt;&lt;span class='body'&gt;"+ body +"&lt;/span&gt;&lt;br /&gt;&lt;span class='url'&gt;"+ url +"&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;";
            }
        } else {
            document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = "&lt;li class='lunrsearchresult'&gt;No results found...&lt;/li&gt;";
        }
    }
    return false;
}
&lt;/script&gt;
&lt;style&gt;
    .lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}
&lt;/style&gt;


&lt;form onSubmit="return lunr_search(document.getElementById('lunrsearch').value);"&gt;
    &lt;p&gt;&lt;input type="text" class="form-control" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Search via Lunr.js" /&gt;&lt;/p&gt;
&lt;/form&gt;
&lt;div id="lunrsearchresults"&gt;
    &lt;ul&gt;&lt;/ul&gt;
&lt;/div&gt;
</code></pre>

<p>[/expand]</p>

<h3 id="installation">Installation</h3>

<p>Step 1. Download the file <a href="https://raw.githubusercontent.com/jhvanderschee/jekyllcodex/gh-pages/_includes/search-lunr.html">search-lunr.html</a>
<br />Step 2. Save the file in the â€˜_includesâ€™ directory of your project
<br />Step 3. Download the file <a href="https://raw.githubusercontent.com/jhvanderschee/jekyllcodex/gh-pages/js/lunr.js">lunr.js</a>
<br />Step 4. Save the file in the â€˜jsâ€™ (root) directory of your project
<br />Step 5. Add the following statement to your layout where you want the search box to appear:</p>

<pre><code>{% include search-lunr.html %}
</code></pre>
:ET